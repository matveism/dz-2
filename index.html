<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bux iQ - Premium Rewards Platform</title>
    
    <!-- Fonts - Windows Mobile Style Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;500;600;700&family=Tahoma:wght@400;700&family=Verdana:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    
    <!-- Google OAuth -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
    :root {
        /* Windows Mobile 6.5 Color Palette - Retro Dark Theme */
        --primary-dark: #0F3A5F;
        --primary-main: #1F4E78;
        --primary-light: #2B5B84;
        --primary-lighter: #3A6B94;
        
        /* Accent Colors - Classic Windows Blue */
        --accent-primary: #1F4E78;
        --accent-secondary: #2B5B84;
        --accent-success: #4A7C59;
        --accent-warning: #8B6914;
        --accent-purple: #4A4E68;
        
        /* Backgrounds - Very Dark Retro */
        --bg-default: #0A0A0A;
        --bg-paper: #1A1A1A;
        --bg-elevated: #2A2A2A;
        
        /* Text Colors - Low Brightness */
        --text-primary: #E0E0E0;
        --text-secondary: #B0B0B0;
        --text-muted: #808080;
        
        /* UI Elements - Classic Beveled Style */
        --border-light: #606060;
        --border-dark: #202020;
        --shadow-dark: 0 2px 4px rgba(0, 0, 0, 0.8);
        --bevel-light: #505050;
        --bevel-dark: #101010;
        --transition: all 0.2s ease;
        
        /* Retro Textures */
        --texture-scanlines: url("data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='scanlines' patternUnits='userSpaceOnUse' width='100' height='4'%3E%3Cline x1='0' y1='0' x2='100' y2='0' stroke='%23000000' stroke-width='1' opacity='0.1'/%3E%3Cline x1='0' y1='2' x2='100' y2='2' stroke='%23000000' stroke-width='1' opacity='0.1'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='url(%23scanlines)'/%3E%3C/svg%3E");
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    body {
        background: 
            linear-gradient(135deg, var(--bg-default) 0%, #050505 100%),
            var(--texture-scanlines);
        color: var(--text-primary);
        font-family: 'Segoe UI', 'Tahoma', sans-serif;
        overflow-x: hidden;
        line-height: 1.4;
        min-height: 100vh;
        position: relative;
        font-size: 13px;
    }
    
    /* CRT Effect for Retro Feel */
    body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
            repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15),
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
        pointer-events: none;
        z-index: 1;
    }
    
    #root {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        position: relative;
        z-index: 2;
    }
    
    /* Windows Mobile 6.5 Header */
    .app-header {
        background: 
            linear-gradient(to bottom, 
                var(--primary-dark) 0%, 
                var(--primary-main) 50%, 
                var(--primary-light) 100%);
        border-bottom: 2px solid var(--bevel-light);
        padding: 8px 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 100;
        /* Classic 3D Beveled Border */
        border-left: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-top: 2px solid var(--bevel-light);
        box-shadow: var(--shadow-dark);
    }
    
    .logo-container {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .logo {
        height: 56px;
        width: auto;
        /* Retro aged/vintage effect */
        filter: 
            sepia(0.3) 
            contrast(1.1) 
            brightness(0.8) 
            blur(0.5px)
            drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.8));
        opacity: 0.85;
        /* Add retro pixelated effect */
        image-rendering: pixelated;
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;
    }
    
    .app-title {
        font-family: 'Segoe UI', 'Tahoma', sans-serif;
        font-size: 16px;
        font-weight: 600;
        color: var(--text-primary);
        letter-spacing: 0px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        position: relative;
    }
    
    .header-actions {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .time-display {
        font-weight: 500;
        color: var(--text-primary);
        font-size: 11px;
        background: var(--bg-elevated);
        padding: 4px 8px;
        border: 2px solid var(--border-dark);
        font-family: 'Segoe UI', sans-serif;
        /* Classic beveled button style */
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
    }
    
    /* Main Content */
    .app-content {
        flex: 1;
        padding: 8px;
        max-width: 1200px;
        margin: 0 auto;
        width: 100%;
    }
    
    /* Dashboard Grid */
    .dashboard-grid {
        display: grid;
        grid-template-columns: 1fr 280px;
        gap: 8px;
        margin-bottom: 8px;
    }
    
    @media (max-width: 1024px) {
        .dashboard-grid {
            grid-template-columns: 1fr;
        }
    }
    
    /* Windows Mobile 6.5 Cards */
    .card {
        background: 
            linear-gradient(to bottom, 
                var(--bg-elevated) 0%, 
                var(--bg-paper) 100%);
        border-radius: 0px;
        padding: 12px;
        /* Classic 3D Beveled Borders */
        border: 2px solid var(--border-dark);
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
        box-shadow: var(--shadow-dark);
        transition: var(--transition);
        position: relative;
    }
    
    .card:hover {
        background: 
            linear-gradient(to bottom, 
                #2A2A2A 0%, 
                var(--bg-paper) 100%);
        /* Inset effect on hover */
        border-left: 2px solid var(--bevel-dark);
        border-top: 2px solid var(--bevel-dark);
        border-right: 2px solid var(--bevel-light);
        border-bottom: 2px solid var(--bevel-light);
    }
    
    .card-header {
        margin-bottom: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid var(--border-dark);
        padding-bottom: 4px;
    }
    
    .card-title {
        font-family: 'Segoe UI', 'Tahoma', sans-serif;
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 6px;
    }
    
    .card-title i {
        color: var(--accent-primary);
    }
    
    .card-actions {
        display: flex;
        gap: 4px;
    }
    
    /* Activity Log */
    .activity-log {
        background: var(--bg-paper);
        border-radius: 0px;
        height: 120px;
        overflow-y: auto;
        padding: 8px;
        font-size: 11px;
        margin-bottom: 8px;
        /* Beveled borders */
        border: 1px solid var(--border-dark);
        border-left: 1px solid var(--bevel-light);
        border-top: 1px solid var(--bevel-light);
        border-right: 1px solid var(--bevel-dark);
        border-bottom: 1px solid var(--bevel-dark);
        font-family: 'Segoe UI', sans-serif;
    }
    
    .activity-item {
        display: flex;
        align-items: center;
        padding: 4px 0;
        border-bottom: 1px solid var(--border-dark);
        transition: var(--transition);
    }
    
    .activity-item:hover {
        background: var(--bg-elevated);
        border-radius: 0px;
        padding-left: 4px;
    }
    
    .activity-item:last-child {
        border-bottom: none;
    }
    
    .activity-icon {
        margin-right: 6px;
        color: var(--accent-primary);
        width: 16px;
        text-align: center;
        font-size: 10px;
    }
    
    /* User Profile */
    .user-profile {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
    }
    
    .user-avatar {
        width: 48px;
        height: 48px;
        border-radius: 0px;
        border: 2px solid var(--accent-primary);
        object-fit: cover;
        /* Retro box shadow */
        box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    }
    
    .user-details {
        flex: 1;
    }
    
    .user-name {
        font-family: 'Segoe UI', 'Tahoma', sans-serif;
        font-weight: 600;
        font-size: 14px;
        margin-bottom: 2px;
    }
    
    .user-level {
        color: var(--text-muted);
        font-size: 10px;
        display: flex;
        align-items: center;
        gap: 4px;
    }
    
    .user-stats {
        display: flex;
        gap: 12px;
    }
    
    .stat {
        text-align: center;
    }
    
    .stat-value {
        font-family: 'Segoe UI', 'Tahoma', sans-serif;
        font-weight: 700;
        font-size: 16px;
        color: var(--accent-primary);
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    }
    
    .stat-label {
        font-size: 9px;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0px;
        font-family: 'Segoe UI', sans-serif;
    }
    
    /* Windows Mobile 6.5 Buttons - Classic 3D Style */
    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
        padding: 6px 12px;
        border-radius: 0px;
        font-weight: 500;
        font-family: 'Segoe UI', sans-serif;
        cursor: pointer;
        transition: none;
        border: 2px solid var(--border-dark);
        font-size: 11px;
        position: relative;
        overflow: hidden;
        text-decoration: none;
        /* Classic 3D Beveled Button Effect */
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
        box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        background: linear-gradient(to bottom, var(--bg-elevated) 0%, var(--bg-paper) 100%);
        color: var(--text-primary);
    }
    
    .btn:active {
        /* Pressed state - inverted bevel */
        border-left: 2px solid var(--bevel-dark);
        border-top: 2px solid var(--bevel-dark);
        border-right: 2px solid var(--bevel-light);
        border-bottom: 2px solid var(--bevel-light);
        box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.8);
        background: linear-gradient(to bottom, var(--bg-paper) 0%, var(--bg-elevated) 100%);
        transform: translate(1px, 1px);
    }
    
    .btn-primary {
        background: linear-gradient(to bottom, var(--primary-light) 0%, var(--primary-main) 100%);
        color: var(--text-primary);
        font-weight: 600;
    }
    
    .btn-primary:active {
        background: linear-gradient(to bottom, var(--primary-main) 0%, var(--primary-dark) 100%);
    }
    
    .btn-secondary {
        background: linear-gradient(to bottom, var(--bg-elevated) 0%, var(--bg-paper) 100%);
        color: var(--text-primary);
    }
    
    .btn-secondary:active {
        background: linear-gradient(to bottom, var(--bg-paper) 0%, var(--bg-elevated) 100%);
    }
    
    .btn-full {
        width: 100%;
    }
    
    /* Windows Mobile 6.5 Tabs */
    .tabs-container {
        display: flex;
        overflow-x: auto;
        margin-bottom: 8px;
        padding-bottom: 2px;
        scrollbar-width: none;
        background: var(--bg-elevated);
        border-radius: 0px;
        padding: 2px;
        /* Beveled border */
        border: 2px solid var(--border-dark);
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
        box-shadow: var(--shadow-dark);
    }
    
    .tabs-container::-webkit-scrollbar {
        display: none;
    }
    
    .tab {
        padding: 6px 10px;
        margin-right: 2px;
        border-radius: 0px;
        background: var(--bg-paper);
        cursor: pointer;
        font-weight: 500;
        white-space: nowrap;
        transition: none;
        /* Beveled tab style */
        border: 1px solid var(--border-dark);
        border-left: 1px solid var(--bevel-light);
        border-top: 1px solid var(--bevel-light);
        border-right: 1px solid var(--bevel-dark);
        border-bottom: 1px solid var(--border-dark);
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        gap: 4px;
        font-family: 'Segoe UI', sans-serif;
        font-size: 11px;
    }
    
    .tab.active {
        background: linear-gradient(to bottom, var(--primary-light) 0%, var(--primary-main) 100%);
        color: var(--text-primary);
        font-weight: 600;
        /* Active tab - different bevel */
        border-left: 1px solid var(--bevel-dark);
        border-top: 1px solid var(--bevel-dark);
        border-right: 1px solid var(--bevel-light);
        border-bottom: 1px solid var(--bevel-light);
    }
    
    .tab:hover:not(.active) {
        background: var(--bg-elevated);
        color: var(--text-primary);
    }
    
    /* Section Management */
    .section {
        display: block;
        animation: fadeIn 0.3s ease;
    }
    
    .section.hidden {
        display: none;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    /* Offer Grid */
    .offer-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 6px;
        margin-bottom: 8px;
    }
    
    .offer-item {
        background: linear-gradient(to bottom, var(--bg-elevated) 0%, var(--bg-paper) 100%);
        border-radius: 0px;
        padding: 8px;
        text-align: center;
        transition: none;
        /* Beveled borders */
        border: 1px solid var(--border-dark);
        border-left: 1px solid var(--bevel-light);
        border-top: 1px solid var(--bevel-light);
        border-right: 1px solid var(--bevel-dark);
        border-bottom: 1px solid var(--bevel-dark);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    
    .offer-item:hover {
        background: linear-gradient(to bottom, #2A2A2A 0%, var(--bg-paper) 100%);
        /* Inset on hover */
        border-left: 1px solid var(--bevel-dark);
        border-top: 1px solid var(--bevel-dark);
        border-right: 1px solid var(--bevel-light);
        border-bottom: 1px solid var(--bevel-light);
    }
    
    .offer-image {
        max-width: 100%;
        height: 40px;
        object-fit: contain;
        margin-bottom: 4px;
        /* Retro image effect */
        filter: brightness(0.8) contrast(1.2) sepia(0.2);
        image-rendering: pixelated;
    }
    
    /* Leaderboard */
    .leaderboard {
        background: var(--bg-paper);
        border-radius: 0px;
        overflow: hidden;
        /* Beveled borders */
        border: 1px solid var(--border-dark);
        border-left: 1px solid var(--bevel-light);
        border-top: 1px solid var(--bevel-light);
        border-right: 1px solid var(--bevel-dark);
        border-bottom: 1px solid var(--bevel-dark);
    }
    
    .leaderboard table {
        width: 100%;
        border-collapse: collapse;
        font-family: 'Segoe UI', sans-serif;
        font-size: 11px;
    }
    
    .leaderboard th {
        background: var(--bg-elevated);
        padding: 6px;
        text-align: left;
        font-weight: 600;
        color: var(--text-secondary);
        border-bottom: 1px solid var(--border-dark);
    }
    
    .leaderboard td {
        padding: 6px;
        border-bottom: 1px solid var(--border-dark);
    }
    
    .leaderboard tr:last-child td {
        border-bottom: none;
    }
    
    .leaderboard tr:hover td {
        background: var(--bg-elevated);
    }
    
    /* Forms */
    .form-group {
        margin-bottom: 8px;
    }
    
    .form-label {
        display: block;
        margin-bottom: 2px;
        font-weight: 500;
        color: var(--text-secondary);
        font-family: 'Segoe UI', sans-serif;
        font-size: 11px;
    }
    
    .form-input {
        width: 100%;
        padding: 4px 6px;
        border-radius: 0px;
        border: 2px solid var(--border-dark);
        background: var(--bg-paper);
        color: var(--text-primary);
        font-family: 'Segoe UI', sans-serif;
        transition: none;
        font-size: 11px;
        /* Beveled input style */
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
    }
    
    .form-input:focus {
        outline: none;
        border-color: var(--accent-primary);
        /* Inset focus effect */
        border-left: 2px solid var(--bevel-dark);
        border-top: 2px solid var(--bevel-dark);
        border-right: 2px solid var(--bevel-light);
        border-bottom: 2px solid var(--bevel-light);
        box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.8);
    }
    
    /* Retro CAPTCHA - Early 2000s Style */
    .captcha-display {
        font-family: 'Courier New', 'Lucida Console', monospace;
        font-size: 18px;
        font-weight: bold;
        letter-spacing: 4px;
        padding: 8px 12px;
        background: linear-gradient(135deg, #1A1A1A 0%, #0A0A0A 100%);
        border: 2px solid var(--border-dark);
        /* Beveled borders for retro feel */
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
        margin-bottom: 8px;
        text-align: center;
        user-select: none;
        /* Pixelated and distorted text effect */
        filter: 
            blur(0.3px) 
            contrast(1.3) 
            brightness(0.9);
        transform: skew(-2deg);
        /* Add noise texture */
        background-image: 
            repeating-linear-gradient(
                45deg,
                transparent,
                transparent 2px,
                rgba(31, 78, 120, 0.1) 2px,
                rgba(31, 78, 120, 0.1) 4px
            ),
            linear-gradient(135deg, #1A1A1A 0%, #0A0A0A 100%);
        /* Retro color with slight blue tint */
        color: #A0C4E0;
        text-shadow: 
            1px 1px 2px rgba(0, 0, 0, 0.8),
            0 0 3px rgba(31, 78, 120, 0.3);
    }
    
    /* Divider */
    .divider {
        display: flex;
        align-items: center;
        text-align: center;
        margin: 8px 0;
        color: var(--text-muted);
    }
    
    .divider::before,
    .divider::after {
        content: '';
        flex: 1;
        border-bottom: 1px solid var(--border-dark);
    }
    
    .divider span {
        padding: 0 8px;
        font-family: 'Segoe UI', sans-serif;
        font-size: 10px;
    }
    
    /* Alert Box - Retro Style */
    .alert {
        padding: 8px;
        border-radius: 0px;
        margin-bottom: 8px;
        display: flex;
        align-items: flex-start;
        border: 2px solid;
        position: relative;
        overflow: hidden;
        font-family: 'Segoe UI', sans-serif;
        font-size: 11px;
        /* Beveled alert box */
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
    }
    
    .alert-warning {
        background: linear-gradient(to bottom, #2A241A 0%, #1A1410 100%);
        border-color: var(--accent-warning);
        color: var(--accent-warning);
    }
    
    .alert-icon {
        margin-right: 6px;
        margin-top: 2px;
        font-size: 12px;
    }
    
    /* FAQ Items */
    .faq-item {
        background: var(--bg-elevated);
        border-radius: 0px;
        padding: 8px;
        margin-bottom: 6px;
        transition: none;
        /* Beveled borders */
        border: 1px solid var(--border-dark);
        border-left: 1px solid var(--bevel-light);
        border-top: 1px solid var(--bevel-light);
        border-right: 1px solid var(--bevel-dark);
        border-bottom: 1px solid var(--bevel-dark);
    }
    
    .faq-item:hover {
        background: #2A2A2A;
        /* Inset effect */
        border-left: 1px solid var(--bevel-dark);
        border-top: 1px solid var(--bevel-dark);
        border-right: 1px solid var(--bevel-light);
        border-bottom: 1px solid var(--bevel-light);
    }
    
    .faq-question {
        margin-bottom: 4px;
        color: var(--accent-primary);
        font-size: 12px;
        font-weight: 600;
        font-family: 'Segoe UI', 'Tahoma', sans-serif;
    }
    
    /* Iframe Container */
    .iframe-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(10, 10, 10, 0.95);
        z-index: 9999;
        display: none;
    }
    
    .iframe-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: var(--primary-dark);
        color: var(--text-primary);
        box-shadow: var(--shadow-dark);
        border-bottom: 2px solid var(--bevel-light);
    }
    
    .iframe-content {
        height: calc(100% - 40px);
        padding: 0 8px 8px;
    }
    
    #dashboardIframe {
        width: 100%;
        height: 100%;
        border: none;
        border-radius: 0px;
        /* Beveled iframe border */
        border: 2px solid var(--border-dark);
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
    }
    
    /* Custom scrollbar - Retro Style */
    ::-webkit-scrollbar {
        width: 12px;
    }
    
    ::-webkit-scrollbar-track {
        background: var(--bg-paper);
        border: 1px solid var(--border-dark);
    }
    
    ::-webkit-scrollbar-thumb {
        background: linear-gradient(to bottom, var(--bg-elevated) 0%, var(--primary-dark) 100%);
        border: 1px solid var(--border-dark);
        /* Beveled scrollbar thumb */
        border-left: 1px solid var(--bevel-light);
        border-top: 1px solid var(--bevel-light);
        border-right: 1px solid var(--bevel-dark);
        border-bottom: 1px solid var(--bevel-dark);
    }
    
    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(to bottom, var(--primary-main) 0%, var(--primary-dark) 100%);
    }
    
    /* Google Sign-In Button Styling */
    .g_id_signin {
        width: 100%;
        margin-bottom: 8px;
    }
    
    /* Custom Google Button Styling */
    .custom-google-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        width: 100%;
        padding: 8px 12px;
        background: white;
        color: #757575;
        border: 1px solid #dadce0;
        border-radius: 4px;
        font-family: 'Roboto', sans-serif;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.3s;
        margin-bottom: 8px;
    }
    
    .custom-google-btn:hover {
        background: #f8f9fa;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .custom-google-btn img {
        width: 18px;
        height: 18px;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .app-header {
            padding: 6px 8px;
        }
        
        .app-content {
            padding: 6px;
        }
        
        .dashboard-grid {
            grid-template-columns: 1fr;
        }
        
        .user-profile {
            flex-direction: column;
            text-align: center;
        }
        
        .user-stats {
            justify-content: center;
        }
        
        .offer-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    @media (max-width: 480px) {
        .app-title {
            font-size: 12px;
        }
        
        .tab {
            padding: 4px 6px;
            font-size: 9px;
        }
        
        .offer-grid {
            grid-template-columns: 1fr;
        }
    }
    
    /* Utility classes */
    .hidden {
        display: none !important;
    }
    
    .text-center {
        text-align: center;
    }
    
    .mb-1 {
        margin-bottom: 4px;
    }
    
    .mb-2 {
        margin-bottom: 6px;
    }
    
    .mb-3 {
        margin-bottom: 8px;
    }
    
    .mt-1 {
        margin-top: 4px;
    }
    
    .mt-2 {
        margin-top: 6px;
    }
    
    .mt-3 {
        margin-top: 8px;
    }
    
    /* Level Badge - Retro Style */
    .level-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(to bottom, var(--accent-warning) 0%, #5A4A14 100%);
        color: var(--text-primary);
        border-radius: 0px;
        padding: 2px 6px;
        font-size: 9px;
        font-weight: 600;
        font-family: 'Segoe UI', sans-serif;
        /* Beveled badge */
        border: 1px solid var(--border-dark);
        border-left: 1px solid var(--bevel-light);
        border-top: 1px solid var(--bevel-light);
        border-right: 1px solid var(--bevel-dark);
        border-bottom: 1px solid var(--bevel-dark);
    }
    
    /* Decorative Elements - Retro Style */
    .ornamental-divider {
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
        margin: 8px 0;
    }
    
    .vintage-border {
        border: 2px solid var(--border-dark);
        position: relative;
        /* Beveled vintage border */
        border-left: 2px solid var(--bevel-light);
        border-top: 2px solid var(--bevel-light);
        border-right: 2px solid var(--bevel-dark);
        border-bottom: 2px solid var(--bevel-dark);
    }
    
    /* Remove modern animations and effects */
    * {
        animation: none !important;
        transition: none !important;
    }
    
    /* Only keep essential transitions for button states */
    .btn:active {
        transition: none;
    }
    
    .section {
        transition: none;
    }
</style>
</head>
<body>
    <div id="root">
        <!-- Windows Mobile 6.5 Header -->
        <header class="app-header">
            <div class="logo-container">
                <img src="https://i.postimg.cc/XvtmtjZL/Gemini-Generated-Image-e6decve6decve6de-removebg-preview.png" width="60px" alt="BUXiQ Logo" class="logo">
            </div>
            <div class="header-actions">
                <div class="time-display" id="headerTime">12:00 PM</div>
            </div>
        </header>
        
        <!-- Main Content -->
        <main class="app-content">
            <!-- Alert Banner -->
            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle alert-icon"></i>
                <div>NEW! $1 = (1) pts & 50% user gets only!</div>
            </div>
            
            <!-- Windows Mobile 6.5 Tabs Navigation -->
            <div class="tabs-container">
                <div class="tab active" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </div>
                <div class="tab" data-section="earn">
                    <i class="fas fa-coins"></i>
                    <span>Earn</span>
                </div>
                <div class="tab" data-section="shop">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Shop</span>
                </div>
                <div class="tab" data-section="leaders">
                    <i class="fas fa-trophy"></i>
                    <span>Leaders</span>
                </div>
                <div class="tab" data-section="bonus">
                    <i class="fas fa-gift"></i>
                    <span>Bonus</span>
                </div>
                <div class="tab" data-section="tos">
                    <i class="fas fa-file-contract"></i>
                    <span>Terms</span>
                </div>
                <div class="tab" data-section="help">
                    <i class="fas fa-question-circle"></i>
                    <span>Help</span>
                </div>
            </div>
            
            <!-- Dashboard Section -->
            <div id="section-dashboard" class="section">
                <div class="dashboard-grid">
                    <div>
                        <!-- Activity Log -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">
                                    <i class="fas fa-list-alt"></i>
                                    Activity Log
                                </h2>
                                <div class="card-actions">
                                    <button class="btn btn-secondary" id="refreshLogs">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="activity-log" id="logs">
                                <div class="activity-item">
                                    <div class="activity-icon"><i class="fas fa-info-circle"></i></div>
                                    <div>Your activity log will appear here</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- User Profile -->
                        <div class="card">
                            <div class="user-profile">
                                <img src="https://ui-avatars.com/api/?background=1F4E78&color=E0E0E0&name=Guest&bold=true" class="user-avatar" id="userAvatar" alt="User Avatar">
                                <div class="user-details">
                                    <div class="user-name" id="userName">Guest User</div>
                                    <div class="user-level">
                                        <span>Level</span>
                                        <span class="level-badge" id="userLevel">0</span>
                                    </div>
                                    <div class="user-stats">
                                        <div class="stat">
                                            <div class="stat-value" id="userBalance">$0.00</div>
                                            <div class="stat-label">Balance</div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-value" id="userPoints">0</div>
                                            <div class="stat-label">Points</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary btn-full" id="loginButton">
                                <i class="fas fa-sign-in-alt"></i>
                                Login to Earn Rewards
                            </button>
                        </div>
                        
                        <!-- How It Works -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">
                                    <i class="fas fa-play-circle"></i>
                                    How It Works
                                </h2>
                            </div>
                            <div class="offer-grid">
                                <div class="offer-item">
                                    <i class="fas fa-tasks" style="font-size: 18px; color: var(--accent-primary); margin-bottom: 4px;"></i>
                                    <h3>Complete Surveys</h3>
                                </div>
                                <div class="offer-item">
                                    <i class="fas fa-star" style="font-size: 18px; color: var(--accent-primary); margin-bottom: 4px;"></i>
                                    <h3>Earn Stars</h3>
                                </div>
                                <div class="offer-item">
                                    <i class="fas fa-gift" style="font-size: 18px; color: var(--accent-primary); margin-bottom: 4px;"></i>
                                    <h3>Redeem Rewards</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <!-- Cashout Options -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">
                                    <i class="fas fa-wallet"></i>
                                    Cashout Options
                                </h2>
                            </div>
                            <div class="offer-grid">
                                <div class="offer-item">
                                    <i class="fab fa-amazon" style="font-size: 18px; color: var(--accent-primary); margin-bottom: 4px;"></i>
                                    <h3>Amazon UK</h3>
                                </div>
                                <div class="offer-item">
                                    <i class="fab fa-bitcoin" style="font-size: 18px; color: var(--accent-primary); margin-bottom: 4px;"></i>
                                    <h3>LTC Crypto</h3>
                                </div>
                                <div class="offer-item">
                                    <i class="fas fa-plus" style="font-size: 18px; color: var(--accent-primary); margin-bottom: 4px;"></i>
                                    <h3>More Soon!</h3>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Server Status -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">
                                    <i class="fas fa-server"></i>
                                    Server Status
                                </h2>
                            </div>
                            <div class="text-center mb-2">
                                <div class="stat-value" style="color: var(--accent-success);">Online</div>
                                <div class="stat-label">All Systems Operational</div>
                            </div>
                            <div id="serverTime" class="text-center">Server Time: 00:00:00</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Earn Section -->
            <div id="section-earn" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-coins"></i>
                            Earning Portal
                        </h2>
                    </div>
                    <div id="login-container">
                        <h3 class="text-center mb-2">Login to Access Offer Walls</h3>
                        
                        <!-- Google Login Button -->
                        <div id="g_id_onload"
                            data-client_id="387422659555-007kjhq0c41f2lq39e075ib5mtpf3q9o.apps.googleusercontent.com"
                            data-context="signin"
                            data-ux_mode="popup"
                            data-callback="handleGoogleCredentialResponse"
                            data-auto_prompt="false">
                        </div>

                        <div class="g_id_signin" 
                             data-type="standard" 
                             data-theme="filled_blue" 
                             data-text="signin_with" 
                             data-shape="rectangular" 
                             data-logo_alignment="left"
                             data-width="full">
                        </div>
                        
                        <div class="divider">
                            <span>OR</span>
                        </div>
                        
                        <!-- Manual Login -->
                        <form class="mt-2">
                            <div class="form-group">
                                <label for="login-account" class="form-label">Account #</label>
                                <input type="text" id="login-account" class="form-input" placeholder="Enter your account number">
                            </div>
                            
                            <div class="form-group">
                                <label for="login-clientid" class="form-label">Client ID</label>
                                <input type="text" id="login-clientid" class="form-input" placeholder="Enter your client ID">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">CAPTCHA</label>
                                <div class="captcha-display" id="captcha"></div>
                                <input type="text" id="captchaInput" class="form-input" placeholder="Enter CAPTCHA">
                            </div>
                            
                            <button type="button" class="btn btn-primary btn-full" id="loginFormButton">
                                <i class="fas fa-sign-in-alt"></i>
                                Login
                            </button>
                        </form>
                        <div id="error-msg" class="hidden mt-2" style="color: #d46b6b; text-align: center; padding: 6px; background: rgba(212, 107, 107, 0.1); border-radius: 0px;"></div>
                    </div>
                    
                    <div id="dashboard" class="hidden">
                        <p class="text-center mb-3">Complete offers and surveys to earn rewards</p>
                        
                        <div class="offer-grid" id="offerwall-grid">
                            <div class="offer-item">
                                <img src="https://i.postimg.cc/LshWhq2y/Gemini-Generated-Image-rueqf9rueqf9rueq-removebg-preview.png" alt="CPX Research Logo" class="offer-image">
                                <button class="btn btn-primary" id="openOfferWallCPX">Open OfferWall</button>
                            </div>

                            <div class="offer-item">
                                <img src="https://i.postimg.cc/6q7RvXyX/Gemini-Generated-Image-p6bmmsp6bmmsp6bm-removebg-preview.png" alt="Excentiv Logo" class="offer-image">
                                <button class="btn btn-primary" id="openOfferWallexcentiv">Open OfferWall</button>
                            </div>

                            <div class="offer-item">
                                <img src="https://i.postimg.cc/76hXmjf9/Gemini-Generated-Image-gwivdggwivdggwiv-removebg-preview.png" alt="ES Logo" class="offer-image">
                                <button class="btn btn-secondary" id="openOfferWalles">WAITING FOR APPROVAL</button>
                            </div>

                            <div class="offer-item">
                                <img src="https://pocketsfull.ai/assets/images/logo.png" alt="PocketsFull Logo" class="offer-image">
                                <button class="btn btn-primary" id="openOfferWallpockets">Open OfferWall</button>
                            </div>

                            <div class="offer-item">
                                <img src="https://siteowner.timewall.io/img/logo/TimeWall_logo_homepage_mobile.png" alt="TimeWall Logo" class="offer-image">
                                <button class="btn btn-primary" id="openOfferWalltw">Open OfferWall</button>
                            </div>

                            <div class="offer-item">
                                <img src="https://revtoo.com/assets/offerwall/images/revtoo-dark.svg" alt="RevToo Logo" class="offer-image">
                                <button class="btn btn-primary" id="openOfferWallrevtoo">Open OfferWall</button>
                            </div>

                            <div class="offer-item">
                                <img src="https://primewall.io/asset/home_1/img/primewalllogo.svg" alt="PrimeWall Logo" class="offer-image">
                                <button class="btn btn-primary" id="openOfferWallprimewall">Open OfferWall</button>
                            </div>
                        </div>
                        
                        <button class="btn btn-secondary btn-full mt-2" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Shop Section -->
            <div id="section-shop" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-shopping-bag"></i>
                            Shop Rewards
                        </h2>
                    </div>
                    <div class="offer-grid">
                        <div class="offer-item">
                            <img src="https://i.postimg.cc/pT1vSNkk/Gemini-Generated-Image-mqybpwmqybpwmqyb-removebg-preview.png" alt="BUXiQ Logo" class="offer-image">
                            <button class="btn btn-primary" id="openOfferWallbuxiq">Cashout</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Leaders Section -->
            <div id="section-leaders" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-trophy"></i>
                            Leaderboard
                        </h2>
                    </div>
                    <div class="leaderboard">
                        <table>
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Username</th>
                                    <th>Earnings</th>
                                    <th>Level</th>
                                </tr>
                            </thead>
                            <tbody id="leaderboardBody">
                                <tr>
                                    <td>1</td>
                                    <td>Loading...</td>
                                    <td>$0.00</td>
                                    <td>0</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Bonus Section -->
            <div id="section-bonus" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-gift"></i>
                            Redeem Bonus Code
                        </h2>
                    </div>
                    
                    <div class="alert alert-warning mb-3">
                        <i class="fas fa-exclamation-triangle alert-icon"></i>
                        <div>WHO FIRST REDEEMED HIS/HER PTS! EACH BONUS CODE WILL BE MARKED AS UNUSED - FIRST COME FIRST SERVED!!!</div>
                    </div>
                    
                    <form id="redeemForm">
                        <div class="form-group">
                            <label for="username" class="form-label">Username</label>
                            <input type="text" id="username" class="form-input" required placeholder="Enter your username">
                        </div>
                        
                        <div class="form-group">
                            <label for="bonusCode" class="form-label">Bonus Code</label>
                            <input type="text" id="bonusCode" class="form-input" required placeholder="Enter bonus code">
                        </div>
                        
                        <button type="button" class="btn btn-primary btn-full" id="redeemBonusButton">
                            <i class="fas fa-gift"></i>
                            Redeem Bonus Code
                        </button>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-top: 8px;">
                            <div class="form-group">
                                <label for="amountLocal" class="form-label">Amount (Local)</label>
                                <input type="text" id="amountLocal" class="form-input" readonly placeholder="0">
                            </div>
                            
                            <div class="form-group">
                                <label for="amountUsd" class="form-label">Amount (USD)</label>
                                <input type="text" id="amountUsd" class="form-input" readonly placeholder="$0.00">
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Terms of Service Section -->
            <div id="section-tos" class="section hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-file-contract"></i>
                            Terms of Service
                        </h2>
                    </div>
                    
                    <div class="alert alert-warning mb-3">
                        <i class="fas fa-exclamation-triangle alert-icon"></i>
                        <div><strong>Important:</strong> Please read these terms carefully before using our services.</div>
                    </div>
                    
                    <div class="mb-3">
                        <h3 class="faq-question">Account Policy</h3>
                        <p>Users are strictly prohibited from maintaining multiple accounts. If we detect multiple accounts associated with a single user, we reserve the right to permanently ban all accounts without any prior notice. This action is permanent and cannot be appealed.</p>
                    </div>
                    
                    <div class="mb-3">
                        <h3 class="faq-question">Activity Requirements</h3>
                        <p>To maintain an active account status, users must complete at least 2 tasks within any 7-day period. Failure to meet this activity requirement may result in account suspension or termination.</p>
                        <p><strong>Please note:</strong> Bonus code redemptions do NOT count toward activity requirements. While level completions may appear to count in the system interface, according to our Terms of Service, they are not considered valid activity for maintaining account status.</p>
                    </div>
                    
                    <div class="mb-3">
                        <h3 class="faq-question">Account Access</h3>
                        <p>If you do not have a Google account, you have two options:</p>
                        <ol>
                            <li>Create a new Google account</li>
                            <li>Contact our support team to receive login credentials</li>
                        </ol>
                    </div>
                    
                    <div class="mb-3">
                        <h3 class="faq-question">General Terms</h3>
                        <p>By using our services, you agree to comply with all applicable laws and regulations. We reserve the right to modify these terms at any time without prior notice. Continued use of our services after changes constitutes acceptance of the modified terms.</p>
                    </div>
                    
                    <div style="display: flex; gap: 6px;">
                        <button type="button" class="btn btn-primary" id="acceptTosButton">I Accept the Terms of Service</button>
                        <button type="button" class="btn btn-secondary" id="declineTosButton">Decline</button>
                    </div>
                </div>
            </div>
            
            <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help & Support</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .card-header {
            background: linear-gradient(to right, #4a00e0, #8e2de2);
            color: white;
            padding: 20px;
        }
        
        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
        }
        
        .card-title i {
            font-size: 1.8rem;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .faq-item {
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .faq-question {
            background: #f8f9fa;
            padding: 15px 20px;
            margin: 0;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
            transition: background 0.3s;
        }
        
        .faq-question:hover {
            background: #e9ecef;
        }
        
        .faq-question i {
            transition: transform 0.3s;
        }
        
        .faq-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
        }
        
        .faq-item.active .faq-answer {
            padding: 20px;
            max-height: 500px;
        }
        
        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            text-decoration: none;
        }
        
        .btn-primary {
            background: linear-gradient(to right, #4a00e0, #8e2de2);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, #3a00b0, #7a1dc2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .mt-2 {
            margin-top: 20px;
        }
        
        h3 {
            color: #4a00e0;
        }
        
        p {
            margin-bottom: 10px;
        }
        
        ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .info-box {
            background: #e8f4fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .warning-box {
            background: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .level-indicator {
            display: flex;
            margin: 10px 0;
        }
        
        .level {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
            color: white;
        }
        
        .level-1 { background: #ff5252; }
        .level-2 { background: #ff9800; }
        .level-3 { background: #4caf50; }
        
        .stars {
            display: flex;
            margin: 10px 0;
        }
        
        .star {
            color: #ffc107;
            font-size: 1.5rem;
            margin-right: 5px;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="section-help" class="section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-question-circle"></i>
                        Help & Support
                    </h2>
                </div>
                
                <div class="card-body">
                    <div class="faq-item active">
                        <h3 class="faq-question">
                            How do I earn points?
                            <i class="fas fa-chevron-down"></i>
                        </h3>
                        <div class="faq-answer">
                            <p>1. If you haven't logged in yet, log in first and then click "Login to Earn" on the home page.</p>
                            <p>2. Click either the "Earn" tab or button at the top or bottom of the page.</p>
                            <p>3. You'll see offerwalls - click on them to complete offers or surveys and earn points!</p>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <h3 class="faq-question">
                            How can I redeem rewards?
                            <i class="fas fa-chevron-down"></i>
                        </h3>
                        <div class="faq-answer">
                            <p>Click the "Shop" tab or button at the top or bottom of the page to browse and redeem available rewards.</p>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <h3 class="faq-question">
                            How to redeem bonus codes?
                            <i class="fas fa-chevron-down"></i>
                        </h3>
                        <div class="faq-answer">
                            <p>Click the <strong>Bonus</strong> tab or button, fill out the form with your account number, and enter the bonus code.</p>
                            <div class="warning-box">
                                <p><strong>Important:</strong> Bonus codes now have stricter eligibility requirements.</p>
                                <p>You need to complete at least 10 tasks within an 8-hour range to be eligible for bonus codes.</p>
                                <p>Check your eligibility status by looking at the stars displayed in the bonus section:</p>
                                <div class="stars">
                                    <i class="fas fa-star star"></i>
                                    <i class="fas fa-star star"></i>
                                    <i class="fas fa-star star"></i>
                                    <i class="far fa-star star"></i>
                                    <i class="far fa-star star"></i>
                                </div>
                                <p>The more stars you have, the closer you are to being eligible for bonus codes.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <h3 class="faq-question">
                            Automatic Activity System
                            <i class="fas fa-chevron-down"></i>
                        </h3>
                        <div class="faq-answer">
                            <div class="info-box">
                                <p>We've added an automatic activity system that checks your account every 8 hours:</p>
                                <ul>
                                    <li>If you stay active, your points remain safe.</li>
                                    <li>If you don't have any activity for 8 hours, a small portion of your points will be temporarily held.</li>
                                    <li>The held amount depends on your Level - lower levels hold more.</li>
                                    <li>Once you reach Level 3 or higher, your balance will no longer be affected by inactivity.</li>
                                </ul>
                                <p><strong> Tip:</strong> Stay active and level up to keep all your points unlocked!</p>
                            </div>
                            
                            <h4>Level Impact on Point Holding</h4>
                            <div class="level-indicator">
                                <div class="level level-1">1</div>
                                <div>Level 1: Highest percentage of points held for inactivity</div>
                            </div>
                            <div class="level-indicator">
                                <div class="level level-2">2</div>
                                <div>Level 2: Moderate percentage of points held for inactivity</div>
                            </div>
                            <div class="level-indicator">
                                <div class="level level-3">3</div>
                                <div>Level 3+: No points held for inactivity</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <h3 class="faq-question">
                            Who do I contact for support?
                            <i class="fas fa-chevron-down"></i>
                        </h3>
                        <div class="faq-answer">
                            <p>Our support team is available from 10 am - 5 pm PST. Click the button below to contact us.</p>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary mt-2" id="contact-support-btn">
                        <i class="fas fa-headset"></i>
                        Contact Support
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Accordion functionality
        document.querySelectorAll('.faq-question').forEach(question => {
            question.addEventListener('click', () => {
                const faqItem = question.parentElement;
                faqItem.classList.toggle('active');
            });
        });
        
        // Contact support button functionality
        document.getElementById('contact-support-btn').addEventListener('click', () => {
            alert('Contact support feature would open here. In a real application, this would open a contact form or chat interface.');
        });
    </script>
</body>
</html>
    
    <!-- Iframe Container -->
    <div class="iframe-container" id="iframeContainer">
        <div class="iframe-header">
            <div>Offer Wall</div>
            <button class="btn btn-secondary" id="closeIframe">Close</button>
        </div>
        <div class="iframe-content">
            <iframe id="dashboardIframe" src=""></iframe>
        </div>
    </div>
    
    <!-- MyChips SDK -->
    <script src="https://v1.mychips.io/SDK/latest/my-chips-sdk.bundle.js"></script>
    
    <script>
    // Global variables
    let captchaCode = '';
    let currentUser = null;
    const adUnit = 'default_ad_unit';

    // Google Apps Script URL for posting data to Google Sheets
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxLwW7NEXLMSDPh1A_PJbTjAucIuji6JtsgVu2xAdaMzXthTKsgk2xyWy83Dx8dO53Rrg/exec';

    // Object with offerwall URLs and open functions
    const offerwallButtons = {
        'openOfferWallCPX': (accountNumber) => `https://offers.cpx-research.com/index.php?app_id=26219&ext_user_id=${accountNumber}&username=${accountNumber}&subid_1=&subid_2`,
        'openOfferWallexcentiv': (accountNumber) => `https://excentiv.com/offerwall/?userid=${accountNumber}&key=q1v8KGQfCjmNeXnhsHyo`,
        'openOfferWallwannads': (accountNumber) => `https://earn.wannads.com/surveywall?apiKey=67d3d43d63631681386947&userId=${accountNumber}`,
        'openOfferWallmc': (accountNumber) => `https://sdk.mychips.io/content?content_id=16cbcd08-387a-498f-b4bd-9f4d2c6883a7&user_id=${accountNumber}&ad_unit_id=${adUnit}`,
        'openOfferWallSPARKWALL': (accountNumber) => `https://spark-wall.com/offerwall/G2kA8XaPF2jjstApSCZsK6aE6qudMN/${accountNumber}&username=${accountNumber}&subid_1=&subid_2`,
        'openOfferWallowm': (accountNumber) => `https://offerwallmedia.com/offerwall/vfox4w1tpz3gflta3gblkkqp8b2aoj/${accountNumber}`,
        'openOfferWalltw': (accountNumber) => `https://timewall.io/users/login?oid=0d54afcf2e6ff561&uid=${accountNumber}`,
        'openOfferWallprimewall': (accountNumber) => `https://primewall.io/offer/Yz3Uj8/${accountNumber}`,
        'openOfferWallrevtoo': (accountNumber) => `https://revtoo.com/offerwall/pmfo7u4ued9x4w5i0tvkrey32rcnwy/${accountNumber}`,
        'openOfferWallbuxiq': (accountNumber) => `https://bux-iq.wasmer.app/cashout.html`,
        'openOfferWallnotik': (accountNumber) => `https://notik.me/coins?api_key=eQpYGMydTs5GP0DfFPQrJotOwKo6V0Hy&pub_id=LJ2g&app_id=GxEBh1Hn3m&user_id=${accountNumber}`
    };

    // DOM Content Loaded - Initialize everything
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded - initializing app');
        
        // Generate initial CAPTCHA
        generateCaptcha();

        // Check for existing session
        checkExistingSession();

        // Initialize all event listeners
        initializeEventListeners();

        // Start server time updates
        updateServerTime();
        setInterval(updateServerTime, 1000);
        
        // Update header time
        updateHeaderTime();
        setInterval(updateHeaderTime, 60000);
        
        // Load activity logs
        fetchCSV();
        
        // Load leaderboard
        loadLeaderboard();
    });

    // Initialize all event listeners
    function initializeEventListeners() {
        console.log('Initializing event listeners');
        
        // Tab click handlers
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', e => {
                e.preventDefault();
                showSection(tab.dataset.section);
                
                // Update active tab
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
            });
        });

        // Login button
        document.getElementById('loginButton')?.addEventListener('click', () => {
            showSection('earn');
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector('.tab[data-section="earn"]').classList.add('active');
        });

        // Login form handler
        document.getElementById('loginFormButton')?.addEventListener('click', handleLogin);

        // Iframe close button
        document.getElementById('closeIframe')?.addEventListener('click', closeIframe);

        // Logout button
        document.getElementById('logoutBtn')?.addEventListener('click', logout);

        // Contact support button
        document.getElementById('contact-support-btn')?.addEventListener('click', () => {
            alert('Please email support@buxiq.com for assistance.');
        });

        // Bonus redeem button
        document.getElementById('redeemBonusButton')?.addEventListener('click', redeemBonusCode);

        // Refresh logs button
        document.getElementById('refreshLogs')?.addEventListener('click', fetchCSV);

        // Initialize offerwall buttons
        initializeOfferwallButtons();
        
        // Terms of Service buttons
        document.getElementById('acceptTosButton')?.addEventListener('click', () => {
            alert('Terms of Service accepted. You can now proceed with registration.');
            showSection('earn');
        });
        
        document.getElementById('declineTosButton')?.addEventListener('click', () => {
            alert('You must accept the Terms of Service to use this platform.');
            showSection('dashboard');
        });
    }

    // Initialize offerwall buttons with user validation
    function initializeOfferwallButtons() {
        Object.keys(offerwallButtons).forEach(buttonId => {
            const button = document.getElementById(buttonId);
            if (button) {
                // Remove any existing listeners to prevent duplicates
                button.replaceWith(button.cloneNode(true));
                const newButton = document.getElementById(buttonId);
                newButton.addEventListener('click', offerwallClickHandler);
            }
        });
    }

    // Handler for offerwall button clicks
    function offerwallClickHandler(e) {
        e.preventDefault();
        console.log('Offerwall button clicked:', this.id);

        if (!currentUser) {
            alert('Please login first to access offerwalls');
            showSection('earn');
            return;
        }

        const buttonId = this.id;
        const urlGenerator = offerwallButtons[buttonId];

        if (!urlGenerator) {
            console.error('No URL generator found for button:', buttonId);
            return;
        }

        // Use user[0] (account number) instead of user[4] (username)
        const accountNumber = currentUser[0] || 'user';
        const url = typeof urlGenerator === 'function' ? urlGenerator(accountNumber) : urlGenerator;

        console.log(`Opening offerwall ${buttonId} for account ${accountNumber}`);
        openIframe(url);
    }

    // Enhanced iframe functions
    function openIframe(url) {
        const iframeContainer = document.getElementById('iframeContainer');
        const dashboardIframe = document.getElementById('dashboardIframe');

        if (!iframeContainer || !dashboardIframe) {
            console.error('Iframe elements not found');
            return;
        }

        dashboardIframe.src = url;
        iframeContainer.style.display = 'block';
    }

    function closeIframe() {
        const iframeContainer = document.getElementById('iframeContainer');
        const dashboardIframe = document.getElementById('dashboardIframe');

        if (iframeContainer && dashboardIframe) {
            iframeContainer.style.display = 'none';
            dashboardIframe.src = '';
        }
    }

    // Update server time display
    function updateServerTime() {
        const now = new Date();

        // Convert to PST (UTC-8) or PDT (UTC-7) depending on daylight saving
        const pstOffset = now.getTimezoneOffset() >= 480 ? -8 * 60 : -7 * 60; // PST is UTC-8, PDT is UTC-7
        const pstTime = new Date(now.getTime() + (now.getTimezoneOffset() - pstOffset) * 60000);

        // Format as HH:MM:SS
        const hours = String(pstTime.getHours()).padStart(2, '0');
        const minutes = String(pstTime.getMinutes()).padStart(2, '0');
        const seconds = String(pstTime.getSeconds()).padStart(2, '0');

        document.getElementById('serverTime').textContent = `Server Time: ${hours}:${minutes}:${seconds} PST`;
    }

    // Update header time
    function updateHeaderTime() {
        const now = new Date();
        const hours = now.getHours();
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const ampm = hours >= 12 ? 'PM' : 'AM';
        const displayHours = hours % 12 || 12;
        
        document.getElementById('headerTime').textContent = `${displayHours}:${minutes} ${ampm}`;
    }

    // Check for existing user session
    function checkExistingSession() {
        const savedAccount = localStorage.getItem('buxiq_account');
        const savedGoogleUser = localStorage.getItem('buxiq_google_user');
        
        console.log('Checking existing session:', { savedAccount, savedGoogleUser });
        
        if (savedGoogleUser) {
            // Handle Google user session restoration with blocked check
            checkAndRestoreGoogleSession(savedGoogleUser);
        } else if (savedAccount) {
            // Handle manual login session restoration
            restoreManualSession(savedAccount);
        } else {
            // Show default section if no session
            showSection('dashboard');
        }
    }

    // Check and restore Google session with blocked validation
    async function checkAndRestoreGoogleSession(savedGoogleUser) {
        try {
            const googleUser = JSON.parse(savedGoogleUser);
            console.log('Restoring Google session for:', googleUser.email);
            
            // Check if user still exists and is not blocked
            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQHuo-I6k4RbAnXvz_FvCzshqg7Cm5dqAXwNkvDLpgpZH84OGUSbX6TiOUfMrCHv3CiNnLnx0IhzNZC/pub?gid=0&single=true&output=csv');
            if (!response.ok) throw new Error('Network response was not ok');

            const data = await response.text();
            const rows = data.trim().split('\n').map(row => row.split(','));

            // Find user by Google ID or email
            const user = rows.find(r => r[7] === googleUser.id || r[8] === googleUser.email);

            if (user) {
                // Check if user is blocked
                const status = (user[2] || '').toLowerCase();
                if (status === 'blocked') {
                    // Clear blocked user session
                    localStorage.removeItem('buxiq_google_user');
                    showSection('dashboard');
                    alert('Your account has been blocked. Please contact support.');
                    return;
                }
                
                // Update stored Google user data with account number
                googleUser.account = user[0];
                googleUser.clientId = user[1];
                localStorage.setItem('buxiq_google_user', JSON.stringify(googleUser));
                
                // User is valid, restore session
                simulateGoogleLoginRestore(googleUser);
            } else {
                // User not found in database, clear session
                localStorage.removeItem('buxiq_google_user');
                console.log('Google user not found in database, session cleared');
            }
        } catch (err) {
            console.error('Error checking Google session:', err);
            // On error, clear session to be safe
            localStorage.removeItem('buxiq_google_user');
        }
    }

    // Restore manual session
    async function restoreManualSession(account) {
        try {
            console.log('Restoring manual session for account:', account);
            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQHuo-I6k4RbAnXvz_FvCzshqg7Cm5dqAXwNkvDLpgpZH84OGUSbX6TiOUfMrCHv3CiNnLnx0IhzNZC/pub?gid=0&single=true&output=csv');
            if (!response.ok) throw new Error('Network response was not ok');

            const data = await response.text();
            const rows = data.trim().split('\n').map(row => row.split(','));

            // Find user by account number
            const user = rows.find(r => r[0] === account);

            if (user) {
                // Check if user is blocked
                const status = (user[2] || '').toLowerCase();
                if (status === 'blocked') {
                    // Clear blocked user session
                    localStorage.removeItem('buxiq_account');
                    alert('Your account has been blocked. Please contact support.');
                    return;
                }
                
                currentUser = user;
                updateUserUI(user);
                
                // Show dashboard
                document.getElementById('login-container').classList.add('hidden');
                document.getElementById('dashboard').classList.remove('hidden');
                
                // Update balance
                await updateBalance();
                
                addToLogs(`Session restored for ${user[4] || 'User'}`);
                console.log('Manual session restored successfully');
            } else {
                // Clear invalid session
                localStorage.removeItem('buxiq_account');
                console.log('Manual session invalid, cleared from storage');
            }
        } catch (err) {
            console.error('Error restoring session:', err);
        }
    }

    // Simulate Google login restore
    function simulateGoogleLoginRestore(googleUser) {
        const simulatedUser = {
            email: googleUser.email,
            name: googleUser.name,
            id: googleUser.id,
            picture: googleUser.picture,
            account: googleUser.account, // Include account number
            clientId: googleUser.clientId // Include client ID
        };
        processGoogleLogin(simulatedUser);
    }

    // Handle Google Sign-In response
    window.handleGoogleCredentialResponse = function(response) {
        console.log("Google Sign-In response received");
        
        // Decode the JWT token to get user info
        const responsePayload = parseJwt(response.credential);
        
        console.log("Google user info:", responsePayload);
        
        // Process Google login with the user info
        processGoogleLogin({
            id: responsePayload.sub,
            email: responsePayload.email,
            name: responsePayload.name,
            picture: responsePayload.picture
        });
    };

    // Parse JWT token
    function parseJwt(token) {
        try {
            const base64Url = token.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            
            return JSON.parse(jsonPayload);
        } catch (e) {
            console.error("Error parsing JWT:", e);
            return null;
        }
    }

    // Process Google Login
    async function processGoogleLogin(googleUser) {
        const errorMsg = document.getElementById('error-msg');
        
        try {
            console.log('Processing Google login for:', googleUser.email);
            
            // Check if user exists in Google Sheets
            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQHuo-I6k4RbAnXvz_FvCzshqg7Cm5dqAXwNkvDLpgpZH84OGUSbX6TiOUfMrCHv3CiNnLnx0IhzNZC/pub?gid=0&single=true&output=csv');
            if (!response.ok) throw new Error('Network response was not ok');

            const data = await response.text();
            const rows = data.trim().split('\n').map(row => row.split(','));

            // Look for user by Google ID or email
            const user = rows.find(r => r[7] === googleUser.id || r[8] === googleUser.email);

            if (user) {
                // Check if user is blocked
                const status = (user[2] || '').toLowerCase();
                if (status === 'blocked') {
                    showError(errorMsg, 'Your account is blocked.');
                    // Clear any stored Google session data
                    localStorage.removeItem('buxiq_google_user');
                    return;
                }

                // Existing user - login
                currentUser = user;
                await completeLogin(user);
                
                // Store session for Google user
                localStorage.setItem('buxiq_google_user', JSON.stringify({
                    id: googleUser.id,
                    email: googleUser.email,
                    name: googleUser.name,
                    picture: googleUser.picture,
                    account: user[0], // Store the generated account number
                    clientId: user[1] // Store the generated client ID
                }));
                
                console.log('Google login successful for existing user');
                
                // Initialize MyChips SDK for this user
                if (typeof myChipsSDK !== 'undefined') {
                    myChipsSDK('init', {userId: user[0]});
                }
            } else {
                // New user - auto-register
                console.log('New Google user, registering...');
                await registerGoogleUser(googleUser);
            }
        } catch (err) {
            console.error('Google login processing error:', err);
            showError(errorMsg, 'Error during Google login. Please try again.');
        }
    }

    // Register new Google user
    async function registerGoogleUser(googleUser) {
        // Generate unique account number and client ID
        const accountNumber = 'G' + Math.random().toString(36).substr(2, 8).toUpperCase();
        const clientId = 'GC' + Math.random().toString(36).substr(2, 6).toUpperCase();
        
        console.log('Registering new Google user with account:', accountNumber);
        
        // Create new user data
        const newUser = [
            accountNumber,      // 0: Account #
            clientId,          // 1: Client ID
            'active',          // 2: Status
            '0.00',           // 3: Balance
            googleUser.name,   // 4: Username
            googleUser.picture, // 5: Avatar URL (Google profile picture)
            '1',              // 6: Level
            googleUser.id,    // 7: Google ID
            googleUser.email  // 8: Google Email
        ];
        
        // Post new user to Google Sheets
        const success = await postUserToSheets(newUser);
        
        if (success) {
            // In a real implementation, you would send this to your backend/Google Apps Script
            // For now, we'll use the new user data directly
            currentUser = newUser;
            
            // Store in localStorage
            localStorage.setItem('buxiq_google_user', JSON.stringify({
                id: googleUser.id,
                email: googleUser.email,
                name: googleUser.name,
                picture: googleUser.picture,
                account: accountNumber,
                clientId: clientId
            }));
            
            await completeLogin(newUser);
            
            // Initialize MyChips SDK for this user
            if (typeof myChipsSDK !== 'undefined') {
                myChipsSDK('init', {userId: accountNumber});
            }
            
            // Show welcome message for new users
            addToLogs(`Welcome ${googleUser.name}! Your account has been created.`);
            console.log('New Google user registered successfully');
        } else {
            alert('Error creating your account. Please try again.');
        }
    }

    // Post user data to Google Sheets
    async function postUserToSheets(userData) {
        try {
            // Prepare data for Google Sheets
            const formData = new FormData();
            formData.append('action', 'addUser');
            formData.append('account', userData[0]);
            formData.append('clientId', userData[1]);
            formData.append('status', userData[2]);
            formData.append('balance', userData[3]);
            formData.append('username', userData[4]);
            formData.append('avatar', userData[5]);
            formData.append('level', userData[6]);
            formData.append('googleId', userData[7]);
            formData.append('googleEmail', userData[8]);
            
            // Send POST request to Google Apps Script
            const response = await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                body: formData
            });
            
            if (response.ok) {
                console.log('User data successfully posted to Google Sheets');
                return true;
            } else {
                console.error('Failed to post user data to Google Sheets');
                return false;
            }
        } catch (error) {
            console.error('Error posting user data to Google Sheets:', error);
            return false;
        }
    }

    // Login handler
    async function handleLogin(e) {
        e.preventDefault();
        console.log('Manual login attempt');

        const account = document.getElementById('login-account')?.value?.trim() || '';
        const clientid = document.getElementById('login-clientid')?.value?.trim() || '';
        const captchaInput = document.getElementById('captchaInput')?.value?.trim() || '';
        const errorMsg = document.getElementById('error-msg');

        // Basic validation
        if (!account || !clientid || !captchaInput) {
            showError(errorMsg, 'Please fill in all fields');
            return;
        }

        if (captchaInput !== captchaCode) {
            showError(errorMsg, 'Invalid CAPTCHA');
            generateCaptcha();
            document.getElementById('captchaInput').value = '';
            return;
        }

        try {
            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQHuo-I6k4RbAnXvz_FvCzshqg7Cm5dqAXwNkvDLpgpZH84OGUSbX6TiOUfMrCHv3CiNnLnx0IhzNZC/pub?gid=0&single=true&output=csv');
            if (!response.ok) throw new Error('Network response was not ok');

            const data = await response.text();
            const rows = data.trim().split('\n').map(row => row.split(','));

            // Find user in spreadsheet data based on account and clientid
            const user = rows.find(r => r[0] === account && r[1] === clientid);

            if (user) {
                const status = (user[2] || '').toLowerCase();
                if (status === 'blocked') {
                    showError(errorMsg, 'Your account is blocked.');
                    // Clear login fields and generate new CAPTCHA on blocked account
                    document.getElementById('login-account').value = '';
                    document.getElementById('login-clientid').value = '';
                    document.getElementById('captchaInput').value = '';
                    generateCaptcha();
                    return;
                }

                // Store current user globally
                currentUser = user;

                // Store in local storage
                localStorage.setItem('buxiq_account', account);

                // Update UI with user data
                updateUserUI(user);

                // Show dashboard
                document.getElementById('login-container')?.classList.add('hidden');
                document.getElementById('dashboard')?.classList.remove('hidden');
                if (errorMsg) errorMsg.classList.add('hidden');

                // Initialize offerwalls for this user
                initializeOfferwallButtons();
                
                // Initialize MyChips SDK for this user
                if (typeof myChipsSDK !== 'undefined') {
                    myChipsSDK('init', {userId: account});
                }

                // Load additional data
                fetchCSV(); // For activity logs
                updateBalance(); // Update balance immediately after login
                
                addToLogs(`Login successful for ${user[4] || 'User'}`);
                console.log('Manual login successful');
            } else {
                showError(errorMsg, 'Invalid credentials');
                // Clear CAPTCHA input and generate new CAPTCHA on invalid credentials
                document.getElementById('captchaInput').value = '';
                generateCaptcha();
            }
        } catch (err) {
            console.error('Login error:', err);
            showError(errorMsg, 'Error loading data. Please try again.');
            // Clear CAPTCHA input and generate new CAPTCHA on error
            document.getElementById('captchaInput').value = '';
            generateCaptcha();
        }
    }

    // Complete login process for both manual and Google login
    async function completeLogin(user) {
        console.log('Completing login for user:', user[4]);
        
        // Update user data
        const avatarUrl = user[5] || `https://ui-avatars.com/api/?name=${encodeURIComponent(user[4] || 'User')}&background=1F4E78&color=E0E0E0`;
        
        // Update UI
        document.getElementById('userAvatar').src = avatarUrl;
        document.getElementById('userName').textContent = user[4] || 'User';
        
        // Show dashboard
        document.getElementById('login-container').classList.add('hidden');
        document.getElementById('dashboard').classList.remove('hidden');
        document.getElementById('error-msg').classList.add('hidden');
        
        // Update balance and level
        await updateBalance();
        
        // Add login success message
        addToLogs(`Login successful for ${user[4] || 'User'}`);
        
        // Show earn section after login
        showSection('earn');
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelector('.tab[data-section="earn"]').classList.add('active');
    }

    // Helper function to show errors
    function showError(element, message) {
        if (element) {
            element.textContent = message;
            element.classList.remove('hidden');
            // Auto-hide error after 5 seconds
            setTimeout(() => {
                element.classList.add('hidden');
            }, 5000);
        } else {
            alert(message);
        }
    }

    // Update user UI after login
    function updateUserUI(user) {
        try {
            const avatarUrl = user[5] || `https://ui-avatars.com/api/?name=${encodeURIComponent(user[4] || 'User')}&background=1F4E78&color=E0E0E0`;

            // Update avatar
            const userAvatar = document.getElementById('userAvatar');
            if (userAvatar) userAvatar.src = avatarUrl;

            // Update username
            const usernameEl = document.getElementById('userName');
            if (usernameEl) usernameEl.textContent = user[4] || 'User';

            // Update level
            const levelEl = document.getElementById('userLevel');
            if (levelEl) levelEl.textContent = user[6] || '1';

            // Update balance
            updateBalance();
        } catch (error) {
            console.error('Error updating user UI:', error);
        }
    }

    // Logout function
    function logout() {
        try {
            console.log('Logging out user');
            
            if (currentUser) {
                // If it's a Google user, remove Google data too
                if (currentUser[7]) { // Google ID exists
                    localStorage.removeItem('buxiq_google_user');
                }
            }

            currentUser = null;
            localStorage.removeItem('buxiq_account');

            document.getElementById('dashboard')?.classList.add('hidden');
            document.getElementById('login-container')?.classList.remove('hidden');
            document.getElementById('login-account').value = '';
            document.getElementById('login-clientid').value = '';
            document.getElementById('captchaInput').value = '';

            const errorMsg = document.getElementById('error-msg');
            if (errorMsg) errorMsg.classList.add('hidden');

            generateCaptcha();
            showSection('dashboard'); // Return to default 'dashboard' section on logout

            // Reset user info display
            const userAvatar = document.getElementById('userAvatar');
            const usernameEl = document.getElementById('userName');
            const levelEl = document.getElementById('userLevel');
            const balanceEl = document.getElementById('userBalance');
            
            if (userAvatar) userAvatar.src = 'https://ui-avatars.com/api/?background=1F4E78&color=E0E0E0&name=Guest&bold=true';
            if (usernameEl) usernameEl.textContent = 'Guest User';
            if (levelEl) levelEl.textContent = '0';
            if (balanceEl) balanceEl.textContent = '$0.00';
            
            addToLogs('You have been logged out.');
            console.log('Logout successful');
        } catch (error) {
            console.error('Error during logout:', error);
        }
    }

    // Generate CAPTCHA
    function generateCaptcha() {
        try {
            captchaCode = Math.floor(10000 + Math.random() * 90000).toString();
            const captchaEl = document.getElementById('captcha');
            if (captchaEl) {
                captchaEl.textContent = captchaCode;
            }
            return captchaCode;
        } catch (error) {
            console.error('Error generating CAPTCHA:', error);
            return '12345'; // Fallback CAPTCHA
        }
    }

    // Navigation handler
    function showSection(section) {
        try {
            const sections = ['dashboard', 'earn', 'shop', 'leaders', 'bonus', 'help', 'tos'];
            sections.forEach(sec => {
                const sectionEl = document.getElementById('section-' + sec);
                if (sectionEl) {
                    sectionEl.classList.toggle('hidden', sec !== section);
                }
            });
        } catch (error) {
            console.error('Error showing section:', error);
        }
    }

    // Update balance function (can be called separately to refresh)
    async function updateBalance() {
        try {
            if (!currentUser) {
                console.warn('Cannot update balance: no current user.');
                return;
            }

            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQHuo-I6k4RbAnXvz_FvCzshqg7Cm5dqAXwNkvDLpgpZH84OGUSbX6TiOUfMrCHv3CiNnLnx0IhzNZC/pub?gid=0&single=true&output=csv');
            if (!response.ok) throw new Error('Network error');

            const data = await response.text();
            const rows = data.trim().split('\n').map(r => r.split(','));
            // Find user by account and clientid for accuracy
            const user = rows.find(r => r[0] === currentUser[0] && r[1] === currentUser[1]);

            const balanceEl = document.getElementById('userBalance');
            const levelEl = document.getElementById('userLevel');

            if (user) {
                // Fix NaN issue by ensuring we have a valid number
                const balance = parseFloat(user[3] || '0');
                if (!isNaN(balance)) {
                    if (balanceEl) balanceEl.textContent = `$${balance.toFixed(2)}`;
                } else {
                    if (balanceEl) balanceEl.textContent = '$0.00';
                }
                
                // Update level
                if (levelEl) levelEl.textContent = user[6] || '1';
                
                // Update currentUser with latest data
                currentUser = user;
            } else {
                // If user not found (e.g., after logout), reset balance display to 0
                if (balanceEl) balanceEl.textContent = '$0.00';
                if (levelEl) levelEl.textContent = '0';
            }
        } catch (err) {
            console.error('Error updating balance:', err);
        }
    }

    // Fetch CSV for activity logs
    async function fetchCSV() {
        try {
            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQ3p3daAnCETfJtrUUvaiNqoUreYkn9FIHus6rEyq-e8E8oLaV51L_NrVWjHp1CyTv3UqBqryq3aH-0/pub?gid=0&single=true&output=csv');
            if (!response.ok) throw new Error('Network error');

            const data = await response.text();
            const rows = data.trim().split('\n').slice(1); // skip header
            const logsContainer = document.getElementById('logs');

            if (!logsContainer) return;
            
            // Clear existing logs except the initial message
            const initialMessage = logsContainer.querySelector('.activity-item');
            logsContainer.innerHTML = '';
            if (initialMessage && rows.length === 0) {
                logsContainer.appendChild(initialMessage);
            }

            let hasLogs = false;
            rows.forEach((row, index) => {
                const cols = row.split(',').map(c => c.trim());
                // Ensure necessary columns exist and are not empty
                if (cols.length >= 7 && cols[2] && cols[6]) {
                    hasLogs = true;
                    const username = cols[2];
                    const amount = parseFloat(cols[6]).toFixed(2); // Format amount to 2 decimal places
                    const logDiv = document.createElement('div');
                    logDiv.className = 'activity-item';
                    logDiv.innerHTML = `
                        <div class="activity-icon"><i class="fas fa-user"></i></div>
                        <div>${username} earned $${amount}</div>
                    `;
                    logsContainer.appendChild(logDiv);
                }
            });

            if (!hasLogs && initialMessage) {
                // Keep the initial message if no logs
            }
        } catch (err) {
            console.error('Error fetching activity logs:', err);
            const logsContainer = document.getElementById('logs');
            if (logsContainer) {
                logsContainer.innerHTML = '<div class="activity-item"><div class="activity-icon"><i class="fas fa-exclamation-triangle"></i></div><div>Error loading activity logs.</div></div>';
            }
        }
    }

    // Load leaderboard from CSV
    async function loadLeaderboard() {
        try {
            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQHuo-I6k4RbAnXvz_FvCzshqg7Cm5dqAXwNkvDLpgpZH84OGUSbX6TiOUfMrCHv3CiNnLnx0IhzNZC/pub?gid=0&single=true&output=csv');
            if (!response.ok) throw new Error('Network error');

            const data = await response.text();
            const rows = data.trim().split('\n').slice(1); // skip header
            
            // Sort users by balance (descending)
            const users = rows.map(row => {
                const cols = row.split(',');
                return {
                    username: cols[4] || 'Unknown',
                    balance: parseFloat(cols[3] || 0),
                    level: cols[6] || '1'
                };
            }).sort((a, b) => b.balance - a.balance).slice(0, 10); // Top 10 users
            
            const leaderboardBody = document.getElementById('leaderboardBody');
            if (!leaderboardBody) return;
            
            leaderboardBody.innerHTML = '';
            
            users.forEach((user, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${user.username}</td>
                    <td>$${user.balance.toFixed(2)}</td>
                    <td>${user.level}</td>
                `;
                leaderboardBody.appendChild(row);
            });
        } catch (err) {
            console.error('Error loading leaderboard:', err);
        }
    }

    // Helper function to add messages to logs
    function addToLogs(message) {
        const logsContainer = document.getElementById('logs');
        const logEntry = document.createElement('div');
        logEntry.className = 'activity-item';
        logEntry.innerHTML = `
            <div class="activity-icon"><i class="fas fa-info-circle"></i></div>
            <div>${new Date().toLocaleTimeString()} - ${message}</div>
        `;
        
        // Remove initial placeholder if it exists
        const initialMessage = logsContainer.querySelector('.activity-item:first-child');
        if (initialMessage && initialMessage.textContent.includes('activity log will appear here')) {
            logsContainer.removeChild(initialMessage);
        }
        
        logsContainer.appendChild(logEntry);
        logsContainer.scrollTop = logsContainer.scrollHeight;
    }

    // Bonus Code Redemption
    async function redeemBonusCode() {
        const username = document.getElementById('username')?.value?.trim();
        const bonusCode = document.getElementById('bonusCode')?.value?.trim();
        
        if (!username || !bonusCode) {
            alert('Please fill in all fields');
            return;
        }
        
        try {
            // Send a request to the Google Apps Script web app to fetch data from the Google Sheets
            const response = await fetch(`https://script.google.com/macros/s/AKfycbxmqOnPJLPuHD6u_DD66bwY0R4MYQ8v9uF1Mv0pm8Sg9APSS4R4oXzbs3zin2FoTMK5/exec?username=${username}&bonusCode=${bonusCode}`);
            const result = await response.text();

            console.log('Bonus redemption result:', result); // For debugging

            if (result.includes("Error")) {
                alert(result);
            } else {
                const [amountLocal, amountUsd] = result.split(','); // Expecting data in format "amountLocal,amountUsd"
                document.getElementById('amountLocal').value = amountLocal;
                document.getElementById('amountUsd').value = amountUsd;
                sendPostback(amountLocal, amountUsd, username, bonusCode); // Call the postback function
                alert('Bonus code redeemed successfully!');
            }
        } catch (error) {
            console.error('Error redeeming bonus code:', error);
            alert('Error redeeming bonus code. Please try again.');
        }
    }

    // Postback Function
    function sendPostback(amountLocal, amountUsd, username, bonusCode) {
        const timestamp = new Date().getTime();
        const postbackUrl = `https://script.google.com/macros/s/AKfycbyvw4LiShTvgnTTLRLISnTYJRhqeStmZgL9YD_ZuQEJubcDPH8bSbGpHPCVHDfx0dbW/exec?status=success&trans_id=${timestamp}&user_id=${username}&bonusCode=${bonusCode}&sub_id=&sub_id_2=&amount_local=${amountLocal}&amount_usd=${amountUsd}&offer_id=offer001&hash=secure_hash_value&ip_click=192.168.1.1`;

        fetch(postbackUrl)
            .then(response => response.json())
            .then(data => console.log('Postback Success:', data))
            .catch(error => console.error('Postback Error:', error));
    }
</script>
</body>
</html>
